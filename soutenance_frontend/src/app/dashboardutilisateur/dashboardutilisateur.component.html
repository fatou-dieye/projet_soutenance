<div class="corps">
  <app-sidebarre></app-sidebarre>
  <div class="utilisateur-main">
    <div class="content-container">
      <div class="map-and-stats-container">
        <div class="chart-box">
          <h3 class="title">Trouver un dépôt</h3>
          <div class="chart-wrapper">
            <div id="map-container"></div>
          </div>
        </div>
        <div class="stats-container">
          <div class="stats-row">
            <!-- Stats cards -->
            <div class="stat-card">
              <div class="stat-icon green">
                <i class="fas fa-users"></i>
              </div>
              <div class="stat-info">
                <h2 class="stat-number">{{ nombreUtilisateurs }}</h2>
                <p class="stat-label">Citoyens Inscrits</p>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon green">
                <img src="Group.png" alt="">
              </div>
              <div class="stat-info">
                <h2 class="stat-number">05</h2>
                <p class="stat-label">Points de dépôt disponibles</p>
              </div>
            </div>
          </div>
          <div class="depots-sauvage">
            <h3 class="title">Les Dépôts Signalés</h3>
            <div class="depots-grid" id="depots-grid">
              <!-- Affichage des alertes -->
              <div *ngFor="let alerte of alertes" class="depot-item">
                <div class="depot-info">
                  <p class="depot-date">{{ alerte.dateCreation | date: 'dd/MM/yyyy' }}</p>
                  <p class="depot-time">{{ alerte.dateCreation | date: 'HH:mm' }}</p>
                  <p class="depot-location">{{ alerte.adresse }}</p>
                </div>
                <div class="depot-icon" (click)="showDetails(alerte)">
                  <i class="fas fa-eye"></i>
                </div>
              </div>
            </div>
            <ng-template #noAlertes>
              <p>Aucune alerte disponible.</p>
            </ng-template>
            <!-- Pagination -->
            <div class="pagination" id="pagination">
              <button (click)="previousPage()" [disabled]="currentPage === 1" aria-label="Page précédente">
                <i class="fas fa-chevron-left"></i>
              </button>
              <span> {{ currentPage }} sur {{ totalPages }}</span>
              <button (click)="nextPage()" [disabled]="currentPage === totalPages" aria-label="Page suivante">
                <i class="fas fa-chevron-right"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>




<!-- Modale pour afficher les détails de l'alerte -->
<div class="modal-overlay" *ngIf="selectedAlerte">
  <div class="modal-container">
    <!-- En-tête du modal -->
    <div class="modal-header">
      <h2>Détails du Signal</h2>
      <button class="close-btn" (click)="closeModal()">✕</button>
    </div>

    <!-- Contenu du modal -->
    <div class="modal-content">

      <!-- Section Date et Adresse -->
      <div class="details-section">
        <p><strong>Date :</strong> {{ selectedAlerte.dateCreation | date: 'dd/MM/yyyy HH:mm' }}</p>
        <p><strong>Adresse :</strong> {{ selectedAlerte.adresse }}</p>
      </div>

      <!-- Section Coordonnées -->
      <div class="location-container">
        <div class="location-icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="#00a86b" stroke-width="2">
            <path d="M12 22s-8-4.5-8-11.8A8 8 0 0 1 12 2a8 8 0 0 1 8 8.2c0 7.3-8 11.8-8 11.8z"/>
            <circle cx="12" cy="10" r="3"/>
          </svg>
        </div>
        <div class="location-details">
          <button (click)="openInMaps()" class="localisation"><h3> Localisation</h3></button>
          <p><strong>Coordonnées :</strong> Latitude: {{ selectedAlerte.coordonnees.latitude }}, Longitude: {{ selectedAlerte.coordonnees.longitude }}</p>
        </div>
      </div>

      <!-- Section Description -->
      <div class="description-section">
        <h3>Description</h3>
        <p>{{ selectedAlerte.description || 'Aucune description' }}</p>
      </div>

      <!-- Section Photos -->
      <div *ngIf="selectedAlerte.photos && selectedAlerte.photos.length > 0" class="photos-section">
        <h3>Photos</h3>
        <div class="photos-grid">
          <div class="photo-container" *ngFor="let photo of selectedAlerte.photos">
            <img [src]="getPhotoUrl(photo)" alt="Photo de l'alerte" class="alert-photo" (error)="photoLoadError($event)">
          </div>
        </div>
      </div>

    </div>
  </div>
</div>

